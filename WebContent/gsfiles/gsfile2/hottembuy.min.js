function WholeSaleTime(){this.CurrDateTime=null}window.Ecshop=window.Ecshop||{};window.Ecshop.HotTemBuy=window.Ecshop.HotTemBuy||{};Ecshop.HotTemBuy.Option={CurrDateTime:null};Ecshop.HotTemBuy.ChengImage=function(n,t){n.parent().parent().each(function(){$(this).find("a").css("color","#706f6f")});var i;i=t==0?$("#hotTemBuyLeftImg"):$("#hotTemBuyRightImg");i.attr("src",n.attr("imgsrc"));i.parent().attr("href",n.attr("href"));n.css("color","red")};Ecshop.HotTemBuy.DateDiff=function(n,t){var i=typeof n,r=typeof t;return i=="string"?n=Ecshop.HotTemBuy.StringToTime(n):n.getTime&&(n=n.getTime()),r=="string"?t=Ecshop.HotTemBuy.StringToTime(t):t.getTime&&(t=t.getTime()),(n-t)/1e3};Ecshop.HotTemBuy.StringToTime=function(n){var t=n.split(" ",2),i=(t[0]?t[0]:"").split("/").length>1?(t[0]?t[0]:"").split("/",3):(t[0]?t[0]:"").split("-",3),r=(t[1]?t[1]:"").split(":",3);return new Date(parseInt(i[0],10)||null,(parseInt(i[1],10)||1)-1,parseInt(i[2],10)||null,parseInt(r[0],10)||null,parseInt(r[1],10)||null,parseInt(r[2],10)||null).getTime()};Ecshop.HotTemBuy.StringToDate=function(n){var t=n.split(" ",2),i=(t[0]?t[0]:"").split("/").length>1?(t[0]?t[0]:"").split("/",3):(t[0]?t[0]:"").split("-",3),r=(t[1]?t[1]:"").split(":",3);return new Date(parseInt(i[0],10)||null,(parseInt(i[1],10)||1)-1,parseInt(i[2],10)||null,parseInt(r[0],10)||null,parseInt(r[1],10)||null,parseInt(r[2],10)||null)};Ecshop.HotTemBuy.SetDateTime=function(n,t,i,r){var h=60,f=h*60,l=f*24,u=0,s=0,c=0,e=0,a=0,o;u=a=parseInt(t/f);s=parseInt((t-u*f)/h);c=parseInt(t-s*h-u*f);e=parseInt(t/l);u=parseInt((t-e*l)/f);e>0?(r?(n.find(".spanDay").html('<strong class="Day"><\/strong>天'),n.find(".Hour").html(u),n.find(".Minute").html(s),n.find(".Second").html(c),n.find(".Day").html(e),t>0?(n.find(".spanDay").show(),n.find(".spanHour").show()):(n.find(".spanDay").hide(),n.find(".spanHour").hide())):(o=Ecshop.HotTemBuy.StringToDate(i),n.prev().length>0&&n.prev().text("活动开始时间"),n.find(".spanDay").html('<strong class="Day"><\/strong>'+(o.getMonth()+1)+"月"+o.getDate()+"日"+o.getHours()+"时"+o.getMinutes()+"分"),n.find(".spanDay").show(),n.find(".spanHour").hide()),n.find(".spanMinute").hide(),n.find(".spanSecond").hide()):(n.prev().length>0&&!r&&n.prev().text("距离活动开始还有"),n.find(".spanDay").hide(),t>0?(n.find(".spanHour").show(),n.find(".spanMinute").show(),n.find(".spanSecond").show()):(n.find(".spanHour").hide(),n.find(".spanMinute").hide(),n.find(".spanSecond").hide()),n.find(".Hour").html(u),n.find(".Minute").html(s),n.find(".Second").html(c),n.find(".Day").html(e))};Ecshop.HotTemBuy.DateFormat=function(n,t){var r={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()},i;/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));for(i in r)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,RegExp.$1.length==1?r[i]:("00"+r[i]).substr((""+r[i]).length)));return t};Ecshop.HotTemBuy.GetServerTime=function(){var n="";return $.ajax({url:"/controls/hottembuy.ashx",type:"POST",data:{type:"getservertime"},dataType:"html",async:!1,success:function(t){Ecshop.HotTemBuy.Option.CurrDateTime=t;n=t},error:function(){n=Ecshop.HotTemBuy.DateFormat(new Date,"yyyy-MM-dd hh:mm:ss")}}),n};Ecshop.HotTemBuy.SetTimeoutObj=null;WholeSaleTime.prototype.RunSetDateTime=function(n,t,i){var u=Ecshop.HotTemBuy.StringToDate(i.CurrDateTime);u.setSeconds(u.getSeconds()+1);i.CurrDateTime=Ecshop.HotTemBuy.DateFormat(u,"yyyy-MM-dd hh:mm:ss");var f=i.CurrDateTime,r=0,e='<span class="end">剩余：<\/span><span class="spanDay"><strong class="Day">0<\/strong>天<\/span><span class="spanHour"><strong class="Hour">0<\/strong>小时<\/span>';e+='<span class="spanMinute"><strong class="Minute">0<\/strong>分<\/span><span class="spanSecond"><strong class="Second">0<\/strong>秒<\/span><span class="begin" style="display: none;">后开始<\/span>';n!=undefined&&n!="undefined"?$(n).find("."+t).each(function(){var u=$(this).attr("isrun")==undefined||$(this).attr("isrun")==null?"0":$(this).attr("isrun");u=="0"&&($(this).find(".end").length==0&&$(this).append(e),$(this).attr("isrun","1"));var t=$(this).attr("begindatetime"),n=Ecshop.HotTemBuy.DateDiff($(this).attr("datetime")==undefined?$(this).attr("dateTime"):$(this).attr("datetime"),f),i=Ecshop.HotTemBuy.DateDiff(f,t);i<0?(n=Ecshop.HotTemBuy.DateDiff(t,f),$(this).find(".begin").show(),$(this).find(".end").hide()):n<0?($(this).find(".end").html("已结束"),$(this).parent().find("#gobuy").html("查看"),r=r+1,n=0):($(this).find(".begin").hide(),$(this).find(".end").show());Ecshop.HotTemBuy.SetDateTime($(this),n,t,!(i<0))}):$(".timebuybox li.left_item .lefttime").each(function(){var f=$(this).attr("isrun")==undefined||$(this).attr("isrun")==null?"0":$(this).attr("isrun"),n;f=="0"&&($(this).html(e),$(this).attr("isrun","1"));n=null;n=this.CurrDateTime==null||this.CurrDateTime==undefined||this.CurrDateTime==""?Ecshop.HotTemBuy.GetServerTime():Ecshop.HotTemBuy.StringToDate(this.CurrDateTime);var i=$(this).attr("begindatetime"),t=Ecshop.HotTemBuy.DateDiff($(this).attr("datetime")==undefined?$(this).attr("dateTime"):$(this).attr("datetime"),n),u=Ecshop.HotTemBuy.DateDiff(n,i);u<0?(t=Ecshop.HotTemBuy.DateDiff(i,n),$(this).find(".begin").show(),$(this).find(".end").hide()):t<0?($(this).find(".end").html("已结束"),$(this).parent().find("#gobuy").html("查看"),r=r+1,t=0):($(this).find(".begin").hide(),$(this).find(".end").show());Ecshop.HotTemBuy.SetDateTime($(this),t,i,!(u<0))});window.setTimeout(i.RunSetDateTime,1e3,n,t,i)};Ecshop.HotTemBuy.RunSetDateTime=function(n,t){var i=new WholeSaleTime;i.CurrDateTime=Ecshop.HotTemBuy.GetServerTime();i.RunSetDateTime(n,t,i)};
(function(h,b){b.topDialog;var c=ECF.dialog=function(a,d,b){var i,h=[],e=c.defaults,g;if(a){function f(a,c){for(var b in c)if(a[b]==undefined)a[b]=c[b];return a}a=f(a,e);g=a.follow=this.nodeType===1&&this||a.follow;a.id=a.id+c.defaults.guid++;return c.list[a.id]=new c.fn._init(a,d,b)}else return new c.fn._init(a,d,b)};c.list={};var g=ECF(document),d=ECF(b);c.fn=c.prototype={version:"1.0.0",build:"2011-10-17",_init:function(a,e,d){var c=this,f;a=c._config(a);c.DOM=f=c._initDOM(a,true);if(!ECF.isArray(a.button))a.button=a.button?[a.button]:[];if(e!==undefined)a.ok=e;if(d!==undefined)a.cancel=d;a.ok&&a.button.push({name:a.okVal,callback:typeof a.ok=="function"?a.ok:c.close,focus:true});a.cancel&&a.button.push({name:a.cancelVal,callback:typeof a.cancel=="function"?a.cancel:c.cancel});c[a.show?"show":"hide"](true);c.button(a.button).title(a.title).content(a.content,true).size(a.width,a.height).time(a.time);a.follow?c.follow(a.follow):c.position(a.left,a.top);c.focus(a.focus);a.lock&&c.lock();c._addEvent();c._ie6PngFix();a.init&&a.init.call(c,b);return c},title:function(c){var a=this,b;if(!a.DOM)a.DOM=a._initDOM();b=a.DOM.titleInfo;if(b)b.innerHTML=c;a.show();return a},content:function(a){if(!this.DOM)this.DOM=this._initDOM();var b=this,c=b.DOM.content,d=b.DOM.wrap,e=b.config,m=d.offsetWidth,l=d.offsetHeight,n=parseInt(d.style.left),o=parseInt(d.style.top),k=d.style.width;d.style.width="auto";b.DOM.main.width="auto";if(typeof a=="string"){if(e.icon&&e.icon!=""){if(c)c.innerHTML="<div style='padding:10px;'><img src='/Skin/dialog/"+e.skin+"/icons/"+e.icon+".png' width='48' height='48' /><span style='margin:auto;vertical-align:middle;'>"+a+"</span></div>"}else if(c)c.innerHTML=a}else if(a&&a.nodeType==1){var j=a.style.display,g=a.previousSibling,f=a.nextSibling,h=a.parentNode;b._elementBack=function(){if(g&&g.parentNode)g.parentNode.insertBefore(a,g.nextSibling);else if(f&&f.parentNode)f.parentNode.insertBefore(a,f);else h&&h.appendChild(a);a.style.display=j;b._elemBack=null};c.innerHTML="";c.appendChild(a);a.style.display="block"}b.show();b.auto();i(c);return b;function i(g){for(var d,b=0,e=0,c=g.getElementsByTagName("script"),f=c.length,a=[];b<f;b++)if(c[b].type==="text/dialog"){a[e]=c[b].innerHTML;e++}if(a.length){a=a.join("");d=new Function(a);d.call(this)}}},auto:function(){var a=this;a.size();a.position();return a},position:function(j,k){if(this.DOM==null||this.DOM==undefined)return;var e=this,d=e.DOM.wrap,f=e.config,c=j||f.left,a=k||f.top,g=ECF(b),h=ECF(document);if(c==="auto")if(f.fixed)c=(g.width()-d.offsetWidth)/2;else{c=(g.width()-h.scrollLeft()-d.offsetWidth)/2;c=c+h.scrollLeft()}else if(c.toString().indexOf("%")!==-1){var i=c==="100%";c=e._toNumber(c,g.width());if(f.fixed)c=c-(i?d.offsetWidth:d.offsetWidth/2);else c=c+h.scrollLeft()/2-(i?d.offsetWidth:d.offsetWidth/2)}d.style.left=c+"px";if(a==="auto")a=(g.height()-d.offsetHeight)/2;else if(a.toString().indexOf("%")!==-1){var l=a==="100%";a=e._toNumber(a,g.height());a=a-(l?d.offsetHeight:d.offsetHeight/2)}a=f.fixed?a:a+h.scrollTop();a=a<0?0:a;d.style.top=a+"px";e.lock();return e},size:function(n,m){var e=this,a=e.DOM,i=a.wrap,h=a.title,d=a.main,c=a.buttons,l=e.config,g=n||l.width,f=m||l.height;if(typeof g==="number")k(g);else{if(g.toString().indexOf("%")!==-1){g=e._toNumber(g,ECF(b).width());k(g)}k()}if(typeof f==="number")j(f);else{if(f.toString().indexOf("%")!==-1){f=e._toNumber(f,ECF(b).height());j(f)}j()}function k(n){h.style.width="auto";c.style.width="auto";var b,m=a.tl.offsetWidth+a.tr.offsetWidth,l=a.ml.offsetWidth+a.mr.offsetWidth,k=a.bl.offsetWidth+a.br.offsetWidth,g=a.buttonsl.offsetWidth+a.buttonsr.offsetWidth,j=a.titlel.offsetWidth+a.titler.offsetWidth;if(n>0)b=n;else{i.style.width="auto";d.style.width="auto";var f=h.offsetWidth;if(e._isIE6()){a.titleInfo.style.width="auto";a.title_Buttons.style.width="auto";f=a.title_Buttons.offsetWidth+a.titleInfo.offsetWidth}var o=Math.max(d.offsetWidth,f,c.offsetWidth),b=o+Math.max(m,l,k,g,j)}i.style.width=b+"px";a.tc.style.width=b-m+"px";h.style.width=b-j+"px";d.style.width=b-l+"px";c.style.width=b-g+"px";a.bc.style.width=b-k+"px"}function j(j){h.style.height="auto";c.style.height="auto";var e,g=h.offsetHeight,b=c.offsetHeight,f=a.tc.offsetHeight+a.bc.offsetHeight;if(j>0)e=j;else{i.style.height="auto";d.style.height="auto";var k=d.offsetHeight,e=g+k+b+f}i.style.height=e+"px";d.style.height=a.ml.style.height=a.mr.style.height=e-g-b-f+"px";c.style.height=a.buttonsl.style.height=a.buttonsr.style.height=b+"px"}return e},move:function(d,h){var d=d?d:b.event,a=this,e=a.DOM.wrap,i=a.config;e.style.zIndex=i.zIndex++;if(!e)return a;if(c.list[a.config.id]!=a)return a;a.focus();if(e.getAttribute("Max")!=0||e.getAttribute("Min")!=0)return a;var h=d.srcElement?d.srcElement:d.target;if(h.className.indexOf("_min")!=-1||h.className.indexOf("_max")!=-1||h.className.indexOf("_close")!=-1)return a;if(!i.drag)return a;var k=a._layer();e.getElementsByTagName("iframe").length>0;if(arguments[2])l(e.id,d,a);else j(e.id,d,a);return a;function l(l,j,d){var d=c.focus,a=d.DOM.dragLayer,e=f(j)-a.style.left.replace("px","")/1,h=g(j)-a.style.top.replace("px","")/1;if(!a)return;if(!b.captureEvents)a.setCapture();else b.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);var i=function(c){c=c?c:b.event;if(!a)return;if(f(c)-e<=0)a.style.left=0+"px";else if(f(c)-e>=d._docWidth()-a.offsetWidth-2)a.style.left=d._docWidth()-a.offsetWidth-2+"px";else a.style.left=f(c)-e+"px";var i=d._docHeight();if(g(c)-h<=1)a.style.top=1+"px";else if(g(c)-h>=i-a.offsetHeight-2)a.style.top=i-a.offsetHeight-2+"px";else a.style.top=g(c)-h+"px"};document.onmousemove=i;k.onmouseup=function(c){if(!a)return;c=c?c:b.event;var m=c.srcElement?c.srcElement:c.target;if(!b.captureEvents)a.releaseCapture();else b.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP);var g=a.style.left.replace("px","")/1,h=a.style.top.replace("px","")/1,e=document.getElementById(l);if(!e)return;var j=e.offsetLeft,k=e.offsetTop;d.moveTo(e,g,h,j,k);if(a)a.style.display="none";var f=document.getElementById("dragtemp0");if(f)f.style.display="none";if(document.onmousemove==i)document.onmousemove=null}}function j(d,c){var a=$(d+"temp");if(!a)return;c=c?c:b.event;var e=a.offsetLeft,h=a.offsetTop;if(!b.captureEvents)a.setCapture();else b.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);document.onmousemove=function(c){if(!a)return;c=c?c:b.event;var i=f(c)-e,d=g(c)-h;if(!/msie/i.test(navigator.userAgent))d-=2;if(i>280&&f(c)<sw)a.style.width=i+"px";if(d-35>10&&g(c)<sh)a.style.height=d+"px"};document.onmouseup=function(){if(!a)return;if(!b.captureEvents)a.releaseCapture();else b.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP);var e=$(d);if(!e)return;var g=e.offsetWidth,f=e.offsetHeight;XDrag.resizeFilm(d,a.offsetWidth,a.offsetHeight,g,f);if(a){a.parentNode.removeChild(a);a=null}var c=document.getElementById("dragtemp0");if(c)if(c.style)c.style.display="none"}}function f(a){return a.pageX?a.pageX:a.clientX+document.body.scrollLeft-document.body.clientLeft}function g(a){return a.pageY?a.pageY:a.clientY+document.body.scrollTop-document.body.clientTop}},moveTo:function(e,c,d,h,i){if(!e)return;if(c<0)c=0;if(d<0)d=0;var j=e.getAttribute("id");typeof b["ct"+j]!="undefined"&&clearTimeout(b["ct"+j]);if(!e)return;if(!this.film){e.style.top=d+"px";e.style.left=c+"px";return}var a=st=20,f=Math.abs(c-h),g=Math.abs(d-i);if(f-g>0)if(g)a=Math.round(f/g)>8?8:Math.round(f/g)*6;else a=0;else if(f)st=Math.round(g/f)>8?8:Math.round(g/f)*6;else st=0;if(c-h<0)a*=-1;if(d-i<0)st*=-1;if(Math.abs(h+a-c)<52&&a)a=a>0?2:-2;if(Math.abs(i+st-d)<52&&st)st=st>0?2:-2;if(Math.abs(h+a-c)<16&&a)a=a>0?1:-1;if(Math.abs(i+st-d)<16&&st)st=st>0?1:-1;if(f==0&&g==0)return;if(Math.abs(h+a-c)<2)e.style.left=c+"px";else e.style.left=h+a+"px";if(Math.abs(i+st-d)<2)e.style.top=d+"px";else e.style.top=i+st+"px";b["ct"+j]=b.setTimeout("moveTo('"+j+"', "+c+" , "+d+", "+(h+a)+", "+(i+st)+")",1)},max:function(e){var d=this,l=d.DOM,b=d.DOM.wrap;if(!b)return;if(b.getAttribute("Min")!=0)return;var m=b.id,c=b.getAttribute("Max");a=arguments[0];if(c==0){var f=document.documentElement.clientWidth,i=b.offsetLeft,j=b.offsetTop,k=b.offsetWidth,h=b.offsetHeight,g=document.documentElement.clientHeight||document.body.scrollHeight;if(f<1)f=document.body.clientWidth;f=f-2;g=g-2;if(d.config.animate)ECF(b).animate({top:"0px",left:"0px",width:f+"px",hieght:g+"px"},800,function(){d.size(f,g)});else{b.style.left="2px";b.style.top="2px";d.size(f,g)}b.setAttribute("Max",i+","+j+","+k+","+h);if(e&&e.tagName=="A")if(e)e.title="恢复"}else{c=c.split(",");if(d.config.animate)ECF(b).animate({left:c[0]+"px",top:c[1]+"px",width:c[2]+"px",hieght:c[3]+"px"},800,function(){d.size(d._toNumber(c[2]),d._toNumber(c[3]))});else{b.style.left=c[0]+"px";b.style.top=c[1]+"px";d.size(d._toNumber(c[2]),d._toNumber(c[3]))}b.setAttribute("Max",0);if(e&&e.tagName=="A")if(e)e.title="最大化"}e&&e.blur();return d},min:function(){var d=this,a=d.DOM.wrap,b=arguments[0];if(a){var c=a.getAttribute("Min"),e=a.getAttribute("MinLocal"),h=a.offsetLeft,i=a.offsetTop,j=a.offsetWidth,g=a.offsetHeight;if(c==0){var f=e?e:getMin(d._local);a.setAttribute("Min",h+","+i+","+j+","+g);a.setAttribute("MinLocal",f);if(b)b.title="恢复"}else{c=c.split(",");a.setAttribute("Min",0);if(b)b.title="最小化"}}b&&b.blur();return d},follow:function(){return this},shake:function(){var d=this,b,c=d.DOM.wrap.style,a=[4,8,4,0,-4,-8,-4,0],e=function(){c.marginLeft=a.shift()+"px";if(a.length<=0){c.marginLeft=0;clearInterval(b)}};a=a.concat(a.concat(a));b=setInterval(e,20);return d},button:function(){var a=this,g=a.DOM,i=g.wrap,d=g.buttons,h=d,f=a.config.className+"_button_focus",c=a._lists=a._lists||{},e=arguments[0];if(e===null||e===undefined||e==""){if(d)d.style.display="none";a.size("auto","auto");return a}ECF.each(e,function(j,d){var g=d.name,i=!c[g],e=!i?c[g].elem:document.createElement("button");if(!c[g])c[g]={};if(d.callback){c[g].callback=d.callback;e.onclick=function(){d.callback&&d.callback.call(a,b)}}if(d.className)e.className=d.className;if(d.focus){a._focus&&a._focus.removeClass(f);a._focus=ECF(e).addClass(f);a.focus()}e[a._expando+"callback"]=g;e.disabled=!!d.disabled;if(i){e.innerHTML=g;c[g].elem=e;h.appendChild(e)}});if(d)d.style.display=e.length?"":"none";a.auto();return a},show:function(){var a=this,b=a.DOM.wrap;if(b&&b.style){if(b.style.display!="none")return a;b.style.display="block";a.config.follow?a.follow(a.config.follow):a.position(a.config.left,a.config.top);a.config.lock&&a.lock()}a.auto();return a},hide:function(){var a=this,b=a.DOM.wrap;if(b&&b.style)b.style.display="none";a.unlock();return a},focus:function(){c.focus=this},close:function(){if(!this.DOM)return this;var a=this,f=a.DOM,e=f.wrap,d=f.dragLayer,g=a.config.close;a.time();if(typeof g==="function"&&g.call(a,b)===false)return a;if(c.focus===a)c.focus=null;a.unlock();e&&e.parentNode&&e.parentNode.removeChild(e);d&&d.parentNode&&d.parentNode.removeChild(d);a.unlock();a.DOM=null;return a},animate:function(d,c){var b=this,a=b.DOM.wrap,e=b._toNumber(a.style.top)-a.offsetHeight/2;if(!c)c=d;if(a)c=="close"&&ECF(a).animate({height:"5px",top:e+"px",opacity:.2},500,function(){b.close(d)})},time:function(b){var a=this,d=a.config.cancelVal,c=a._timer;c&&clearTimeout(c);if(b)a._timer=setTimeout(function(){a.animate(d,"close")},1e3*b);return a},lock:function(){var e=this,i=b.VBArray&&!b.XMLHttpRequest,g=e.DOM,a=g.lockMask||document.getElementById("full_lock_dialog_Div"),f=e.config;if(a){this.DOM.lockMask=a;var d=Math.max(document.documentElement.clientWidth,document.documentElement.offsetWidth-22);if(d<$("body").width())d=$("body").width();a.style.width=d+"px";a.style.height=Math.max(document.getElementsByTagName("body")[0].scrollHeight,document.documentElement.offsetHeight,ECF(document).height())+"px";a.style.display="block"}else{a=document.createElement("div");document.getElementsByTagName("body")[0].appendChild(a);a.id="full_lock_dialog_Div";a.oncontextmenu=function(){return false};var c=a.style;c.zIndex=f.zIndex-2;c.position="absolute";c.left="0px";c.top="0px";var d=Math.max(document.documentElement.clientWidth,document.documentElement.offsetWidth-22);if(d<$("body").width())d=$("body").width();c.width=d+"px";c.height=Math.max(document.getElementsByTagName("body")[0].scrollHeight,document.documentElement.offsetHeight,ECF(document).height())+"px";c.background=f.background;if(i)a.innerHTML='<iframe src="about:blank" style="position:absolute; visibility:inherit; top:0px; left:0px; width:100%; height:100%; z-index:-1; filter=\'progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=1)\';"></iframe>';function h(a,c,b){if(typeof a!="object")a=$(a);switch(c){case"opacity":if(a.filters){a.style.filter="alpha(opacity="+b*100+")";if(!a.currentStyle.hasLayout)a.style.zoom=1}else{a.style.opacity=b;a.style["-moz-opacity"]=b;a.style["-khtml-opacity"]=b}break;default:a.style[c]=b}a=null}h(a,"opacity",f.opacity);g.lockMask=a;e.DOM=g}return e},unlock:function(){var a=this;if(a.DOM.lockMask){var b=a.DOM.lockMask.style;if(b)b.display="none"}return a},_local:[],_docWidth:function(){var a=Math.max(document.body.clientWidth,document.body.scrollWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth);if(a<$("body").width())a=$("body").width();return a},_docHeight:function(){return Math.max(document.body.clientHeight,document.body.scrollHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight)},_initDOM:function(f,l){var a={},d,e=f.className,n=f.width,m=f.height,g=this;g.config=f=l?f:g._config(f);a.wrap=d=b(document.getElementsByTagName("body")[0],e);d.setAttribute("id",f.id);d.setAttribute("Max",0);d.setAttribute("Min",0);d.setAttribute("drag","true");d.onmousedown=k;d.style.position=f.fixed?"fixed":"absolute";d.style.zIndex=f.zIndex++;a.tl=b(d,e+"_top_left");a.tc=b(d,e+"_top_center");a.tr=b(d,e+"_top_right");b(d,"clear");a.titlel=b(d,e+"_title_left");a.title=b(d,e+"_title");a.titleInfo=b(a.title,e+"_title_info","b");a.title_Buttons=b(a.title,e+"_title_buttons","span");b(a.title,"clear");a.titler=b(d,e+"_title_right");b(d,"clear");a.ml=b(d,e+"_main_left"),a.main=b(d,e+"_main"),a.main.style.margin="0px";a.content=b(a.main,e+"_content");a.mr=b(d,e+"_main_right");b(a.wrap,"clear","","");a.buttonsl=b(d,e+"_buttons_left"),a.buttons=b(d,e+"_buttons"),a.buttonsr=b(d,e+"_buttons_right"),b(a.wrap,"clear","","");a.bl=b(d,e+"_bottom_left");a.bc=b(d,e+"_bottom_center");a.br=b(d,e+"_bottom_right");b(a.wrap,"clear");f.drag&&ECF(a.title).css("cursor","move");if(typeof f.title=="boolean"&&!f.title){a.titlel.style.display="none";a.title.style.display="none";a.titler.style.display="none"}if(f.closeBtn){var h=a.close=b(a.title_Buttons,e+"_title_close","a");h.href="javascript:void(0)";h.onclick=function(){f.animate?g.animate("close"):g.close(this)};h.title="关闭"}if(f.maxBtn){var i=a.max=b(a.title_Buttons,e+"_title_max","a");i.href="javascript:void(0)";i.onclick=function(){g.max(this)};i.title="最大化"}if(f.minBtn){var j=a.min=b(a.title_Buttons,e+"_title_min","a");j.href="javascript:void(0)";j.onclick=function(){g.min(this)};j.title="最小化"}a.title.onmousedown=function(a){g.move(a,this,1)};if(f.reHeight){a.ml.onmousedown=function(a){g.move(a,this)};a.mr.onmousedown=function(a){g.move(a,this)}}if(f.reWidth){a.tc.onmousedown=function(a){g.move(a,this)};a.bc.onmousedown=function(a){g.move(a,this)}}if(f.reSize)br.onmousedown=function(a){g.move(a,this)};function b(){var c=arguments[0],b=arguments[1]||"",e=arguments[2]||"DIV",d=arguments[3]||"",a=document.createElement(e);if(!c)return;d!=""&&a.setAttribute("id",d);if(b!="")a.className=b;c.appendChild(a);return a}function k(){c.defaults.zIndex=f.zIndex++;return false}return a},_layer:function(){var c=this,b=c.DOM.wrap,a=c.DOM.dragLayer;if(!a){c.DOM.dragLayer=a=document.createElement("DIV");document.getElementsByTagName("body")[0].appendChild(a)}a.oncontextmenu=function(){return false};a.id=b.id+"temp";a.name=b.id+"temp";a.style.cssText=b.style.cssText+"position:absolute;background:#D2E1F0;filter:alpha(Opacity=10,style=0);opacity:0.3;cursor:move;";a.style.height=b.offsetHeight+"px";a.style.border="2px dotted #919090";a.style.zIndex=b.style.zIndex+2;a.style.width=b.style.width;a.style.height=b.style.height;a.style.left=b.style.left;a.style.top=b.style.top;return a},_toNumber:function(a,c){if(!a&&a!==0||typeof a==="number")return a;var b=a.length-2;if(a.lastIndexOf("px")===b)a=parseInt(a);else if(a.lastIndexOf("%")===b+1)a=parseInt(c*a.split("%")[0]/100);return parseInt(a)},_isIE6:function(){return ECF.browser.msie&&ECF.browser.version<7},_ie6PngFix:function(){if(this._isIE6())for(var d=0,b,c,e,a,g="skin/dialog/default/",f=this.DOM.wrap.getElementsByTagName("*");d<f.length;d++){b=f[d];c=b.currentStyle.png;if(c){e=g+c;a=b.runtimeStyle;a.backgroundImage="none";a.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"',sizingMethod='crop')"}}},_expando:"ecDialog"+(new Date).getTime(),_config:function(a){a=a||{};var f={},b="createTouch"in document&&!("onmousemove"in f)||/(iPhone|iPad|iPod)/i.test(navigator.userAgent);if(typeof a==="string"||a.nodeType===1)a={content:a,fixed:!b};var d=c.defaults;a=e(a,d);if(b)a.fixed=false;c.defaults.zIndex=a.zIndex;function e(a,c){for(var b in c)if(a[b]==undefined)a[b]=c[b];return a}return a},_reset:function(i){var c,a=this,h=a._winSize||d.width()*d.height(),e=a._follow,k=a._width,j=a._height,f=a._left,g=a._top;if(i){c=a._winSize=d.width()*d.height();if(h===c)return}if(e)a.follow(e);else(f||g)&&a.position(f,g);if(!a.DOM)return;var b=a.DOM.lockMask;if(b){b.style.width=a._docWidth()+"px";b.style.height=a._docHeight+"px"}},_addEvent:function(){var c,e,a=this,f="CollectGarbage"in b,g=a.DOM;a._winResize=function(){c&&clearTimeout(c);c=setTimeout(function(){a._reset(f)},4)};d.bind("resize",a._winResize);if(a.config.scroll){a._winScroll=function(){e&&clearTimeout(e);e=setTimeout(function(){var b=a._left,c=a._top;(b||c)&&a.position(b,c)},4)};d.bind("scroll",a._winScroll)}},_removeEvent:function(){ECF(this.DOM.wrap).unbind();d.unbind("resize",this._winResize);d.unbind("scroll",this._winScroll)}};c.defaults={id:"ecdialog",guid:0,title:"消息",url:"",content:'<div class="box_loading"><span>loading...</span></div>',button:null,ok:null,cancel:null,init:null,close:null,okVal:"确定",cancelVal:"取消",width:"auto",height:"auto",minWidth:120,minHeight:32,padding:"20px 25px",skin:"default",className:"box",icon:null,time:null,esc:true,focus:true,show:true,follow:null,path:"",lock:true,background:"#000",opacity:.4,duration:300,fixed:false,left:"auto",top:"auto",zIndex:1982,resize:true,drag:true,closeBtn:true,minBtn:false,maxBtn:false,scroll:false,animate:false};c.fn._init.prototype=c.fn;ECF.extend(c,{info:{version:"1.0.0 Beta",summary:"EC Framework Dragbox JS Library<br /> ECF 框架之弹出层(拖动)插件",aouthor:"xp",build:"2011-9-29",release:"2011-10-18",modify:"2011-10-19",mender:"xp",modSummary:"1.调整层的样式,可根据文本内容自动适应大小(2011-10-12)<br />2.修正在ie6下不能使用的问题,但在ie6下还是存一些小的问题没有时间处理(2011-10-18)"},notice:function(k){var a=k||{},d,j,f,b,g,i=500,e={id:"Notice",left:"100%",top:"100%",fixed:true,drag:false,resize:false,follow:null,lock:false,maxBtn:false,minBtn:false,init:function(c){d=this;j=d.config;b=ECF(d.DOM.wrap);g=parseInt(b[0].style.top);f=g+b[0].offsetHeight;b.css("top",f+"px").animate({top:g+"px"},i,function(){a.init&&a.init.call(d,c)})},close:function(c){b.animate({top:f+"px"},i,function(){a.close&&a.close.call(this,c);j.close=null;d.close()});return false}};for(var h in a)if(e[h]===undefined)e[h]=a[h];return c(e)},alert:function(a){return c({id:"Alert",icon:"warning",fixed:true,lock:true,drag:false,content:a,closeBtn:false,ok:true}).shake()},confirm:function(d,a,b){return c({id:"Confirm",icon:"question",fixed:true,lock:true,opacity:.1,content:d,ok:function(b){return a&&a.call(this,b)},cancel:function(a){return b&&b.call(this,a)}})},prompt:function(e,d,b){b=b||"";var a;return c({id:"Prompt",icon:"question",fixed:true,lock:true,opacity:.1,content:['<div style="margin-bottom:5px;font-size:12px">',e,"</div>","<div>",'<input value="',b,'" style="width:18em;padding:6px 4px" />',"</div>"].join(""),init:function(){a=ECF(this.DOM.content).find("input")[0];a.select();a.focus()},ok:function(b){return d&&d.call(this,a.value,b)},cancel:true})},tips:function(a,b){return c({id:"Tips",title:false,cancel:false,fixed:true,closeBtn:false,lock:false}).content('<div style="padding: 10px;">'+a+"</div>").time(b||1.5)},open:function(i,a,t){a=a||{};var e,g,h,s,d,j,u,k,v,l=c.top,f,q="position:absolute;left:-9999em;top:-9999em;border:none 0;background:transparent;width:500px;height:500px;",r="width:100%;height:100%;border:none 0;";if(t===false){var p=(new Date).getTime(),o=i.replace(/([?&])_=[^&]*/,"$1_="+p);i=o+(o===i?(/\?/.test(i)?"&":"?")+"_="+p:"")}var n=function(){var f,c,a=ECF(g.content).find(".box_loading"),b=e.config;typeof a[0]=="object"&&g.content.removeChild(a[0]);setTimeout(function(){d.style.cssText=r},0)},f={zIndex:1982,maxBtn:false,minBtn:false,width:a.width||500,height:a.height||400,init:function(){e=this;g=e.DOM;s=g.main;h=g.content;f=e.config;g.content.style.width="100%";g.content.style.height="100%";d=e.iframe=document.createElement("iframe");d.src=i;d.name="Open_"+e.config.id;d.style.cssText=q;d.setAttribute("frameborder",0,0);d.setAttribute("allowTransparency",true);j=ECF(d);h.style.margin="0";h.appendChild(d);e.size(f.width,f.height).position();k=d.contentWindow;b.topDialog=k.ecDialog=k.parent.ecDialog=e;j.bind("load",n)},close:function(){j.css("display","none").unbind("load",n);if(a.close&&a.close.call(this,d.contentWindow,l)===false)return false;j[0].src="about:blank";for(var b=0;b<h.childNodes.length;b++)h.removeChild(h.childNodes[b]);try{}catch(c){}}};if(typeof a.ok==="function")f.ok=function(){return a.ok.call(e,d.contentWindow,l)};if(typeof a.cancel==="function")f.cancel=function(){return a.cancel.call(e,d.contentWindow,l)};delete a.content;for(var m in a)if(f[m]===undefined)f[m]=a[m];return c(f)},through:function(){var a=this.top.apply(this,arguments);if(this.top()!==b)c.list[a.config.id]=a;return a},top:function(){var a=b,c=function(a){try{var c=b[a].document;c.getElementsByTagName}catch(d){return false}return b[a].ecDialog&&c.getElementsByTagName("frameset").length===0};if(c("top"))a=b.top;else if(c("parent"))a=b.parent;return a}});g.bind("keydown",function(d){var b=d.target;if(!b)return;var e=b.nodeName,g=/^INPUT|TEXTAREA$/,a=c.focus,f=d.keyCode;if(!a||!a.config.esc||g.test(e))return;f===27&&a._click(a.config.cancelVal)});try{document.execCommand("BackgroundImageCache",false,true)}catch(i){}ECF.plugin&&ECF.plugin.push("dialog");var e;_path=b._ecDialog_path||function(a,c,b){for(c in a)if(a[c].src&&a[c].src.toLowerCase().indexOf("dialog")!==-1)b=a[c];e=b||a[a.length-1];b=e.src.replace(/\\/g,"/");return b.lastIndexOf("/")<0?".":b.substring(0,b.lastIndexOf("/"))}(document.getElementsByTagName("script"));_skin=e.src.split("skin=")[1];if(_skin){var f=document.createElement("link");f.rel="stylesheet";f.href=_path+"/skins/"+_skin+"/Dialog.min.css?"+c.fn.version;e.parentNode.insertBefore(f,e)}ECF(function(){function a(a,c){var d=new RegExp("(^|&)"+c+"=([^&]*)(&|$)"),b=a.substr(a.indexOf("?")+1).match(d);return b!=null?unescape(b[2]):null}ECF("a.dialog,a.thickbox").each(function(b){if(!b)return;var c=b.href,f=a(c,"width")||600,e=b.title||b.innerHTML,d=a(c,"height")||400;b.onclick=function(){ECF.dialog.open(c,{width:f/1,height:d/1,title:e},false);return false}})})})(ECF,window);